{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# Security Operations Efficiency"
      },
      "customWidth": "35",
      "name": "Main headline"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "parameters": [
          {
            "id": "688dc7cb-bea3-41ae-ae94-32d22e09568c",
            "version": "KqlParameterItem/1.0",
            "name": "DefaultWorkspace",
            "type": 5,
            "isRequired": true,
            "value": "value::1",
            "isHiddenWhenLocked": true,
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.operationalinsights/workspaces": true
              },
              "additionalResourceOptions": [
                "value::1"
              ]
            }
          },
          {
            "id": "c11b5651-cf86-4865-b23d-9ecc4f16b712",
            "version": "KqlParameterItem/1.0",
            "name": "ContextFree",
            "type": 1,
            "query": "{\"version\":\"1.0.0\",\"content\":\"\\\"{DefaultWorkspace}\\\"\"}\r\n",
            "isHiddenWhenLocked": true,
            "queryType": 8
          },
          {
            "id": "bbbc300a-6f91-4b2b-b4b5-842b4bf8577a",
            "version": "KqlParameterItem/1.0",
            "name": "Selection",
            "type": 1,
            "query": "where type =~ 'microsoft.operationalinsights/workspaces'\r\n| extend match = strcat(\"'\", id, \"'\") =~ \"{DefaultWorkspace:value}\"\r\n| order by match desc, name asc\r\n| take 1\r\n| project value = tostring(pack('sub', subscriptionId, 'rg', resourceGroup, 'ws', id))",
            "crossComponentResources": [
              "value::selected"
            ],
            "isHiddenWhenLocked": true,
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "1db5ee15-fe52-458b-91d1-7ee39d8c2cd3",
            "version": "KqlParameterItem/1.0",
            "name": "Subscriptions",
            "type": 6,
            "isRequired": true,
            "query": "summarize by subscriptionId\r\n| project value = strcat('/subscriptions/', subscriptionId), label = subscriptionId, selected = iff(subscriptionId =~ todynamic('{Selection}').sub, true, false)",
            "crossComponentResources": [
              "value::selected"
            ],
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "9732eff8-fb57-4cbd-8ade-5ae746f33760",
            "version": "KqlParameterItem/1.0",
            "name": "Workspaces",
            "type": 5,
            "isRequired": true,
            "query": "resources\r\n| where type =~ 'microsoft.operationalinsights/workspaces'\r\n| summarize by id, name\r\n| project id, selected = iff(id =~ todynamic('{Selection}').ws, true, false)",
            "crossComponentResources": [
              "{Subscriptions}"
            ],
            "typeSettings": {
              "resourceTypeFilter": {
                "microsoft.operationalinsights/workspaces": true
              }
            },
            "queryType": 1,
            "resourceType": "microsoft.resourcegraph/resources"
          },
          {
            "id": "7d597ad7-4a2a-45ed-a4fe-7ee32de0fc22",
            "version": "KqlParameterItem/1.0",
            "name": "TimeRange",
            "label": "Incident Creation Time",
            "type": 4,
            "isRequired": true,
            "typeSettings": {
              "selectableValues": [
                {
                  "durationMs": 14400000
                },
                {
                  "durationMs": 43200000
                },
                {
                  "durationMs": 86400000
                },
                {
                  "durationMs": 172800000
                },
                {
                  "durationMs": 259200000
                },
                {
                  "durationMs": 604800000
                },
                {
                  "durationMs": 1209600000
                },
                {
                  "durationMs": 2592000000
                },
                {
                  "durationMs": 5184000000
                },
                {
                  "durationMs": 7776000000
                }
              ],
              "allowCustom": true
            },
            "value": {
              "durationMs": 7776000000
            }
          },
          {
            "id": "3a87d4f7-42cc-4c62-b543-6b5d9ab8cf27",
            "version": "KqlParameterItem/1.0",
            "name": "Severity",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| summarize Count = count(IncidentNumber) by Severity\r\n| project Value = Severity, Label = strcat(Severity, \": \", Count)",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "High"
            ]
          },
          {
            "id": "81085d3a-5aca-488e-b7c6-ecf1167e59f7",
            "version": "KqlParameterItem/1.0",
            "name": "Tactics",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| mvexpand Tactics to typeof(string)\r\n| summarize Count=count(IncidentNumber) by Tactics\r\n| project Value = Tactics, Label = strcat(Tactics, \": \", Count)",
            "crossComponentResources": [
              "{Workspaces}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "0f9efb0d-ac34-41d0-8a19-165840eb2a71",
            "version": "KqlParameterItem/1.0",
            "name": "Owner",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| extend owner = tostring(Owner.assignedTo) \r\n| summarize Count=count(IncidentNumber) by Owner= case(owner==\"\", \"Unassigned\",owner)\r\n| project Value = Owner, Label = strcat(Owner, \": \", Count)",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "cf86113b-59ad-4fc9-aeb7-9b44e230641e",
            "version": "KqlParameterItem/1.0",
            "name": "Product",
            "label": "Product Name",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| extend Product = tostring(parse_json(tostring(AdditionalData.alertProductNames))[0]) \r\n| summarize Count=count(IncidentNumber) by Product\r\n| project Value = Product, Label = strcat(Product, \": \", Count)\r\n",
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 7776000000
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "baa92cd2-7ade-41c3-a07c-a11f5ce3e0e6",
            "version": "KqlParameterItem/1.0",
            "name": "Help",
            "label": "Show Help",
            "type": 10,
            "isRequired": true,
            "jsonData": "[{ \"value\": \"Yes\", \"label\": \"Yes\"},\r\n {\"value\": \"No\", \"label\": \"No\", \"selected\":true }]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "above",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "customWidth": "100",
      "name": "parameters - 6"
    },
    {
      "type": 11,
      "content": {
        "version": "LinkItem/1.0",
        "style": "tabs",
        "links": [
          {
            "id": "38f8e74b-e463-43d3-a79e-2dec5dc060a7",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Overview",
            "subTarget": "Overview",
            "style": "link"
          },
          {
            "id": "2fe05e4a-f2af-4466-9742-faeed9190d48",
            "cellValue": "SelectedTab",
            "linkTarget": "parameter",
            "linkLabel": "Rule Analysis",
            "subTarget": "RuleAnalysis",
            "style": "link"
          }
        ]
      },
      "name": "links - 12"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Overview",
        "expandable": true,
        "expanded": true,
        "items": [
          {
            "type": 1,
            "content": {
              "json": "## Incidents created over time"
            },
            "customWidth": "67",
            "name": "Incidents over time - headline"
          },
          {
            "type": 1,
            "content": {
              "json": "## Incidents by closing classification"
            },
            "customWidth": "32",
            "name": "Incidents by classification - headline"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData,CreatedTime) by IncidentNumber\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize count() by bin(CreatedTime, 1h)\n\n\n\n",
              "size": 1,
              "timeBrushParameterName": "TimeBrush",
              "exportFieldName": "CreatedTime",
              "exportParameterName": "TimePicker",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "visualization": "unstackedbar",
              "gridSettings": {
                "sortBy": [
                  {
                    "itemKey": "CreatedTime",
                    "sortOrder": 2
                  }
                ]
              },
              "sortBy": [
                {
                  "itemKey": "CreatedTime",
                  "sortOrder": 2
                }
              ],
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "count_",
                    "label": "Incidents"
                  }
                ]
              }
            },
            "customWidth": "67",
            "name": "Incidents over time "
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime >= {TimeBrush:start} and CreatedTime <= {TimeBrush:end}\n| where Status == 'Closed'\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| extend feedback =strcat(Classification,\" \",ClassificationReason)\n| summarize dcount(IncidentNumber) by feedback\n",
              "size": 1,
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "visualization": "piechart"
            },
            "customWidth": "33",
            "name": "Incidents by classification - headline"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| summarize arg_max(TimeGenerated,Status, Severity, Owner, AdditionalData) by IncidentNumber\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize dcount(IncidentNumber) by Severity",
              "size": 1,
              "title": "Incidents created by severity",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Classification",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              },
              "chartSettings": {
                "seriesLabelSettings": [
                  {
                    "seriesName": "Informational",
                    "color": "gray"
                  },
                  {
                    "seriesName": "Low",
                    "color": "yellow"
                  },
                  {
                    "seriesName": "Medium",
                    "color": "orange"
                  },
                  {
                    "seriesName": "High",
                    "color": "red"
                  }
                ]
              }
            },
            "customWidth": "22",
            "name": "By severity"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData) by IncidentNumber\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize count() by case(tostring(Owner)==\"\", \"Unassigned\",tostring(Owner))\n\n",
              "size": 1,
              "title": "Incidents created by owner",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Classification",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "22",
            "name": "By owner"
          },
          {
            "type": 3,
            "content": {
              "version": "KqlItem/1.0",
              "query": "SecurityIncident\n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData) by IncidentNumber\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize count() by Status\n",
              "size": 1,
              "title": "Incidents created by status",
              "queryType": 0,
              "resourceType": "microsoft.operationalinsights/workspaces",
              "crossComponentResources": [
                "{Workspaces}"
              ],
              "visualization": "piechart",
              "tileSettings": {
                "showBorder": false,
                "titleContent": {
                  "columnMatch": "Classification",
                  "formatter": 1
                },
                "leftContent": {
                  "columnMatch": "dcount_IncidentNumber",
                  "formatter": 12,
                  "formatOptions": {
                    "palette": "auto"
                  },
                  "numberFormat": {
                    "unit": 17,
                    "options": {
                      "maximumSignificantDigits": 3,
                      "maximumFractionDigits": 2
                    }
                  }
                }
              }
            },
            "customWidth": "22",
            "name": "By status"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 1,
                  "content": {
                    "json": "Time to triage, is the time between the incident creation and its first update.",
                    "style": "info"
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Help",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Help1"
                },
                {
                  "type": 1,
                  "content": {
                    "json": "Time to closure, is the time between the incident creation and its last closure.",
                    "style": "info"
                  },
                  "customWidth": "50",
                  "conditionalVisibility": {
                    "parameterName": "Help",
                    "comparison": "isEqualTo",
                    "value": "Yes"
                  },
                  "name": "Help1 - Copy"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityIncident\n| where FirstModifiedTime  >= {TimeRange:start} and FirstModifiedTime  <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize arg_max(LastModifiedTime,*) by IncidentNumber \n| extend TimeToTriage =  (FirstModifiedTime - CreatedTime)/1h\n| summarize AvgTTT=avg(TimeToTriage) \n",
                    "size": 1,
                    "title": "Mean time to triage",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "AvgTTT",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 26,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 3
                          }
                        }
                      },
                      "showBorder": false,
                      "size": "auto"
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTT"
                },
                {
                  "type": 3,
                  "content": {
                    "version": "KqlItem/1.0",
                    "query": "SecurityIncident\n| where ClosedTime >= {TimeRange:start} and ClosedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize arg_max(TimeGenerated,*) by IncidentNumber \n| extend TimeToClosure =  (ClosedTime - CreatedTime)/1h\n| summarize AvgTTC=avg(TimeToClosure)",
                    "size": 1,
                    "title": "Mean time to closure ",
                    "queryType": 0,
                    "resourceType": "microsoft.operationalinsights/workspaces",
                    "crossComponentResources": [
                      "{Workspaces}"
                    ],
                    "visualization": "tiles",
                    "tileSettings": {
                      "titleContent": {
                        "columnMatch": "Classification",
                        "formatter": 1
                      },
                      "leftContent": {
                        "columnMatch": "AvgTTC",
                        "formatter": 12,
                        "formatOptions": {
                          "palette": "auto"
                        },
                        "numberFormat": {
                          "unit": 26,
                          "options": {
                            "style": "decimal",
                            "useGrouping": false,
                            "maximumFractionDigits": 3
                          }
                        }
                      },
                      "showBorder": false,
                      "size": "auto"
                    }
                  },
                  "customWidth": "50",
                  "name": "MTTM"
                }
              ]
            },
            "customWidth": "34",
            "name": "Mean times"
          },
          {
            "type": 12,
            "content": {
              "version": "NotebookGroup/1.0",
              "groupType": "editable",
              "items": [
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by severity over time "
                        },
                        "name": "text - 2 - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize Incidents=dcount(IncidentNumber) by Severity, bin(CreatedTime, 1d)",
                          "size": 1,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "query - 2 - Copy - Copy"
                      }
                    ]
                  },
                  "name": "Incidents severity over time"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by owner over time "
                        },
                        "name": "text - 2 - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize Incidents=dcount(IncidentNumber) by case(tostring(Owner)==\"\", \"Unassigned\",tostring(Owner)), bin(CreatedTime, 1d)\n",
                          "size": 1,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "query - 2 - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "name": "Incident owner over time"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by status over time"
                        },
                        "name": "text - 2 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize Incidents=dcount(IncidentNumber) by Status, bin(CreatedTime, 1d)",
                          "size": 1,
                          "exportFieldName": "series",
                          "exportParameterName": "Status",
                          "exportDefaultValue": "All",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "query - 2 - Copy"
                      }
                    ]
                  },
                  "name": "Incident status over time",
                  "styleSettings": {
                    "margin": "0",
                    "padding": "0"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by product over time"
                        },
                        "name": "text - 2 - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize Incidents=dcount(IncidentNumber) by tostring(Product), bin(CreatedTime, 1d)",
                          "size": 1,
                          "exportFieldName": "series",
                          "exportParameterName": "Status",
                          "exportDefaultValue": "All",
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "linechart"
                        },
                        "name": "query - 2 - Copy"
                      }
                    ]
                  },
                  "name": "Incident status over time - Copy",
                  "styleSettings": {
                    "margin": "0",
                    "padding": "0"
                  }
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by tactics over time "
                        },
                        "name": "text - 2 - Copy - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| mvexpand Tactics to typeof(string)\n| summarize Incidents=dcount(IncidentNumber) by Tactics, bin(CreatedTime, 1d)",
                          "size": 1,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "unstackedbar"
                        },
                        "name": "query - 2 - Copy - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "name": "Incidents tactic over time"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by tags over time "
                        },
                        "name": "text - 2 - Copy - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| extend Tags = extract_all('labelName\":\"(.*?)\"',tostring(Labels))\n| mvexpand Tags to typeof(string)\n| summarize Incidents=dcount(IncidentNumber) by Tags, bin(CreatedTime, 1d)",
                          "size": 1,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "unstackedbar"
                        },
                        "name": "query - 2 - Copy - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "name": "Incidents tactic over time - Copy"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 1,
                        "content": {
                          "json": "## Incidents created by name"
                        },
                        "name": "text - 2 - Copy - Copy - Copy - Copy"
                      },
                      {
                        "type": 3,
                        "content": {
                          "version": "KqlItem/1.0",
                          "query": "SecurityIncident \n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| summarize arg_max(TimeGenerated, Status, Severity, Owner, AdditionalData,CreatedTime) by IncidentNumber, Title\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize count() by bin(CreatedTime, 1h), Title\n| order by count_ desc",
                          "size": 1,
                          "queryType": 0,
                          "resourceType": "microsoft.operationalinsights/workspaces",
                          "crossComponentResources": [
                            "{Workspaces}"
                          ],
                          "visualization": "piechart"
                        },
                        "name": "query - 2 - Copy - Copy - Copy - Copy"
                      }
                    ]
                  },
                  "name": "Incidents tactic over time - Copy - Copy"
                },
                {
                  "type": 12,
                  "content": {
                    "version": "NotebookGroup/1.0",
                    "groupType": "editable",
                    "items": [
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Time to triage (percentiles)"
                              },
                              "name": "text - 2 - Copy - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "Time to triage, is the time between the incident creation and its first update.",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help2"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where FirstModifiedTime  >= {TimeRange:start} and FirstModifiedTime  <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize arg_max(LastModifiedTime,*) by IncidentNumber \n| extend TimeToTriage =  (FirstModifiedTime - CreatedTime)/1h\n| summarize 5th_Percentile=max_of(percentile(TimeToTriage, 5),0),50th_Percentile=percentile(TimeToTriage, 50), 90th_Percentile=percentile(TimeToTriage, 90),99th_Percentile=percentile(TimeToTriage, 99) by bin(FirstModifiedTime, 1d)\n",
                                "size": 1,
                                "aggregation": 3,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "linechart",
                                "chartSettings": {
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 26,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true,
                                        "maximumFractionDigits": 3
                                      }
                                    }
                                  }
                                }
                              },
                              "name": "query - 2 - Copy - Copy"
                            }
                          ]
                        },
                        "name": "Incidents severity over time"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Time to closure (percentiles)\r\n"
                              },
                              "name": "text - 2 - Copy - Copy - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "Time to closure, is the time between the incident creation and its last closure.",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help3"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where ClosedTime  >= {TimeRange:start} and ClosedTime  <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize arg_max(LastModifiedTime,*) by IncidentNumber \n| extend TimeToClosure =  (ClosedTime - CreatedTime)/1h\n| summarize 5th_Percentile=percentile(TimeToClosure, 5),50th_Percentile=percentile(TimeToClosure, 50), 90th_Percentile=percentile(TimeToClosure, 90),99th_Percentile=percentile(TimeToClosure, 99) by bin(ClosedTime, 1d)\n",
                                "size": 1,
                                "aggregation": 3,
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "linechart",
                                "gridSettings": {
                                  "sortBy": [
                                    {
                                      "itemKey": "percentile_MinToTriage_5",
                                      "sortOrder": 2
                                    }
                                  ]
                                },
                                "sortBy": [
                                  {
                                    "itemKey": "percentile_MinToTriage_5",
                                    "sortOrder": 2
                                  }
                                ],
                                "tileSettings": {
                                  "showBorder": false
                                },
                                "chartSettings": {
                                  "ySettings": {
                                    "numberFormatSettings": {
                                      "unit": 26,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": true,
                                        "maximumFractionDigits": 3
                                      }
                                    },
                                    "min": 0
                                  }
                                }
                              },
                              "name": "query - 2 - Copy - Copy - Copy"
                            }
                          ]
                        },
                        "name": "Incident owner over time"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Mean time to closure per owner\r\n"
                              },
                              "name": "text - 2 - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "The mean time between the incident creation and last closure by owner",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help3 - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where CreatedTime >= {TimeBrush:start} and CreatedTime <= {TimeBrush:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n|where Status == 'Closed'  \n| extend Ownerr = case(tostring(Owner)==\"\", \"Unassigned\",tostring(Owner))\n| summarize arg_min(LastModifiedTime,*) by IncidentNumber, Owner = Ownerr\n| extend TimeToTriage = LastModifiedTime - CreatedTime, Owner\n| summarize avg(TimeToTriage/1h) by Owner\n",
                                "size": 4,
                                "exportFieldName": "series",
                                "exportParameterName": "Status",
                                "exportDefaultValue": "All",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "Owner",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "avg_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 26,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false,
                                        "maximumFractionDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false
                                }
                              },
                              "name": "query - 2 - Copy"
                            }
                          ]
                        },
                        "name": "Incident status over time",
                        "styleSettings": {
                          "margin": "0",
                          "padding": "0"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Mean time to triage per owner\r\n"
                              },
                              "name": "text - 2 - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "The mean time between the incident creation and first modification by owner",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help3 - Copy - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where CreatedTime >= {TimeRange:start} and CreatedTime <= {TimeRange:end}\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize arg_max(FirstModifiedTime,*) by IncidentNumber \n| extend TimeToTriage =  FirstModifiedTime - CreatedTime\n| extend MinToTriage = TimeToTriage/1h\n| summarize avg(TimeToTriage/1h) by owner=case(tostring(Owner)==\"\", \"Unassigned\",tostring(Owner))\n\n",
                                "size": 4,
                                "exportFieldName": "series",
                                "exportParameterName": "Status",
                                "exportDefaultValue": "All",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "owner",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "avg_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 26,
                                      "options": {
                                        "style": "decimal",
                                        "useGrouping": false,
                                        "maximumFractionDigits": 3
                                      }
                                    }
                                  },
                                  "showBorder": false
                                }
                              },
                              "name": "query - 2 - Copy"
                            }
                          ]
                        },
                        "name": "Incident status triage",
                        "styleSettings": {
                          "margin": "0",
                          "padding": "0"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Actions per user"
                              },
                              "name": "text - 2 - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "The number of actions taken on incidents per incident modifier",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help3 - Copy - Copy - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where CreatedTime >= {TimeBrush:start} and CreatedTime <= {TimeBrush:end}\n| where ModifiedBy !in(\"Alert Grouping\",\"Fusion\",\"Incident created from alert\")\n| where ModifiedBy !contains(\"Automation rule\")\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| summarize count() by ModifiedBy\n",
                                "size": 4,
                                "exportFieldName": "series",
                                "exportParameterName": "Status",
                                "exportDefaultValue": "All",
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "tiles",
                                "tileSettings": {
                                  "titleContent": {
                                    "columnMatch": "ModifiedBy",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "count_",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    }
                                  },
                                  "showBorder": false,
                                  "sortCriteriaField": "count_",
                                  "sortOrderField": 2
                                }
                              },
                              "name": "query - 2 - Copy"
                            }
                          ]
                        },
                        "name": "Incident status over time - Copy",
                        "styleSettings": {
                          "margin": "0",
                          "padding": "0"
                        }
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Recent activities"
                              },
                              "name": "text - 2 - Copy - Copy - Copy - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "Most recent activities taken on incidents",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help3 - Copy - Copy - Copy - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| order by LastModifiedTime \n| project LastModifiedTime,IncidentNumber, Title, Product, IncidentUrl, ModifiedBy,Status, Severity, Owner\n| take 250\n\n\n",
                                "size": 1,
                                "timeContext": {
                                  "durationMs": 86400000
                                },
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "IncidentUrl",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "Url",
                                        "linkLabel": "Go to incident >"
                                      }
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "LastModifiedTime",
                                      "label": "Last Modified Time"
                                    },
                                    {
                                      "columnId": "IncidentNumber",
                                      "label": "Incident Number"
                                    },
                                    {
                                      "columnId": "IncidentUrl",
                                      "label": "Link to incident"
                                    },
                                    {
                                      "columnId": "ModifiedBy",
                                      "label": "Modified By"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Column1",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "IncidentNumber",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "name": "query - 2 - Copy - Copy - Copy - Copy"
                            }
                          ]
                        },
                        "name": "Incidents tactic over time - Copy"
                      },
                      {
                        "type": 12,
                        "content": {
                          "version": "NotebookGroup/1.0",
                          "groupType": "editable",
                          "items": [
                            {
                              "type": 1,
                              "content": {
                                "json": "## Recent incident closing classification"
                              },
                              "name": "text - 2 - Copy - Copy - Copy - Copy"
                            },
                            {
                              "type": 1,
                              "content": {
                                "json": "Recent closing classifications and comments of incidents",
                                "style": "info"
                              },
                              "customWidth": "100",
                              "conditionalVisibility": {
                                "parameterName": "Help",
                                "comparison": "isEqualTo",
                                "value": "Yes"
                              },
                              "name": "Help3 - Copy - Copy - Copy - Copy - Copy"
                            },
                            {
                              "type": 3,
                              "content": {
                                "version": "KqlItem/1.0",
                                "query": "SecurityIncident\n| where Severity in ({Severity}) or \"*\" in ({Severity})\n| extend Tactics = todynamic(AdditionalData.tactics)\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\n| extend Owner = todynamic(Owner.assignedTo) \n| where Owner in ({Owner}) or \"*\" in ({Owner})\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \n| where Product in ({Product}) or \"*\" in ({Product})\n| where Status == 'Closed'\n| order by LastModifiedTime \n| project LastModifiedTime,IncidentNumber, Title, Classification, ClassificationReason,ClassificationComment, Product, IncidentUrl, ModifiedBy,Status, Severity,Owner\n| take 250\n\n\n",
                                "size": 1,
                                "timeContext": {
                                  "durationMs": 604800000
                                },
                                "queryType": 0,
                                "resourceType": "microsoft.operationalinsights/workspaces",
                                "crossComponentResources": [
                                  "{Workspaces}"
                                ],
                                "visualization": "table",
                                "gridSettings": {
                                  "formatters": [
                                    {
                                      "columnMatch": "IncidentUrl",
                                      "formatter": 7,
                                      "formatOptions": {
                                        "linkTarget": "Url",
                                        "linkLabel": "Go to incident >"
                                      }
                                    }
                                  ],
                                  "labelSettings": [
                                    {
                                      "columnId": "LastModifiedTime",
                                      "label": "Last Modified Time"
                                    },
                                    {
                                      "columnId": "IncidentNumber",
                                      "label": "Incident Number"
                                    },
                                    {
                                      "columnId": "ClassificationReason",
                                      "label": "Classification Reason"
                                    },
                                    {
                                      "columnId": "ClassificationComment",
                                      "label": "Classification Comment"
                                    },
                                    {
                                      "columnId": "IncidentUrl",
                                      "label": "Link to incident"
                                    },
                                    {
                                      "columnId": "ModifiedBy",
                                      "label": "Modified By"
                                    }
                                  ]
                                },
                                "tileSettings": {
                                  "showBorder": false,
                                  "titleContent": {
                                    "columnMatch": "Column1",
                                    "formatter": 1
                                  },
                                  "leftContent": {
                                    "columnMatch": "IncidentNumber",
                                    "formatter": 12,
                                    "formatOptions": {
                                      "palette": "auto"
                                    },
                                    "numberFormat": {
                                      "unit": 17,
                                      "options": {
                                        "maximumSignificantDigits": 3,
                                        "maximumFractionDigits": 2
                                      }
                                    }
                                  }
                                }
                              },
                              "name": "query - 2 - Copy - Copy - Copy - Copy"
                            }
                          ]
                        },
                        "name": "Incidents tactic over time - Copy"
                      }
                    ]
                  },
                  "customWidth": "50",
                  "name": "Over time right panel"
                }
              ]
            },
            "customWidth": "50",
            "name": "Over time left panel"
          }
        ],
        "exportParameters": true
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "Overview"
      },
      "name": "Overview"
    },
    {
      "type": 12,
      "content": {
        "version": "NotebookGroup/1.0",
        "groupType": "editable",
        "title": "Rule Analysis",
        "expandable": true,
        "items": []
      },
      "conditionalVisibility": {
        "parameterName": "SelectedTab",
        "comparison": "isEqualTo",
        "value": "RuleAnalysis"
      },
      "name": "Rule Analysis"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "parameters": [
          {
            "id": "609e19df-e938-4ec7-aa8d-da6d293956c6",
            "version": "KqlParameterItem/1.0",
            "name": "IncidentTitle",
            "label": "Incident Title",
            "type": 2,
            "isRequired": true,
            "multiSelect": true,
            "quote": "'",
            "delimiter": ",",
            "query": "SecurityIncident\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| where Severity in ({Severity}) or \"*\" in ({Severity})\r\n| extend Tactics = todynamic(AdditionalData.tactics)\r\n| where Tactics in ({Tactics}) or \"*\" in ({Tactics})\r\n| extend Owner = todynamic(Owner.assignedTo) \r\n| where Owner in ({Owner}) or \"*\" in ({Owner})\r\n| extend Product = todynamic((parse_json(tostring(AdditionalData.alertProductNames))[0])) \r\n| where Product in ({Product}) or \"*\" in ({Product})\r\n| summarize Count=count() by Title\r\n| order by Count\r\n| project Value=replace(@'\\\\', @'\\\\\\\\', Title), Label = strcat(Title, \": \", Count)\r\n",
            "crossComponentResources": [
              "{Workspaces}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [
                "value::all"
              ],
              "selectAllValue": "*",
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange",
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": [
              "value::all"
            ]
          },
          {
            "id": "334e5ca8-c2f4-4587-b715-b0dfb893a574",
            "version": "KqlParameterItem/1.0",
            "name": "AutomatedTriage",
            "label": "Automation in Triage?",
            "type": 10,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n {\"value\": \"True\", \"label\": \"True\"},\r\n {\"value\": \"False\", \"label\": \"False\"}\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "2fc6c56a-3db0-4fba-86d5-41d2171b3cdd",
            "version": "KqlParameterItem/1.0",
            "name": "AutomatedClosure",
            "label": "Automation in Closure?",
            "type": 10,
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "jsonData": "[\r\n {\"value\": \"True\", \"label\": \"True\"},\r\n {\"value\": \"False\", \"label\": \"False\"}\r\n]",
            "timeContext": {
              "durationMs": 0
            },
            "timeContextFromParameter": "TimeRange"
          },
          {
            "id": "eb8454df-71b1-4e77-a897-865e486cf917",
            "version": "KqlParameterItem/1.0",
            "name": "ClosedXDR",
            "label": "Closed by XDR",
            "type": 10,
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "jsonData": "[\r\n {\"value\": \"True\", \"label\": \"True\"},\r\n {\"value\": \"False\", \"label\": \"False\"}\r\n]",
            "timeContext": {
              "durationMs": 7776000000
            },
            "timeContextFromParameter": "TimeRange"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 5"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "//Time To triage:\r\nlet TimeIntervals = datatable(TimeInterval: string)\r\n[\r\n    \"00-05 minutes\",\r\n    \"05-10 minutes\",\r\n    \"10-15 minutes\",\r\n    \"15-20 minutes\",\r\n    \"20-25 minutes\",\r\n    \"25-30 minutes\",\r\n    \"more than 30 minutes\",\r\n    \"n.a.\"\r\n];\r\nlet Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n| where \"{AutomatedTriage}\"==\"\" or TriagedByAutomation == \"{AutomatedTriage:value}\"\r\n| where \"{ClosedXDR}\"==\"\" or ClosedByXDRCorrelation == \"{ClosedXDR:value}\"\r\n| extend Classification=iff(ClosedByXDRCorrelation==true,\"XDR\",Classification)\r\n| summarize IncidentCount=count() by AcknowledgeTimeInterval,Classification,ClosedByAutomation\r\n| join kind=leftouter TimeIntervals on $left.AcknowledgeTimeInterval==$right.TimeInterval\r\n// Visualize the data\r\n| project TimeInterval, IncidentCount = coalesce(IncidentCount, 0),Classification\r\n| order by TimeInterval asc\r\n| render columnchart with (kind=stacked)\r\n",
        "size": 0,
        "showAnalytics": true,
        "title": "Acknowledge distribution time",
        "timeContextFromParameter": "TimeRange",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "IncidentId",
            "parameterName": "IncidentId",
            "parameterType": 1
          }
        ],
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "chartSettings": {
          "xAxis": "TimeInterval",
          "yAxis": [
            "IncidentCount"
          ],
          "group": "Classification",
          "createOtherGroup": null,
          "showLegend": true,
          "seriesLabelSettings": [
            {
              "seriesName": "<empty>",
              "label": "Open"
            }
          ],
          "xSettings": {
            "label": "Time taken to triage"
          },
          "ySettings": {
            "label": "Incidents"
          }
        }
      },
      "customWidth": "33",
      "name": "query - 6 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "//Time To triage:\r\nlet TimeIntervals = datatable(TimeInterval: string)\r\n[\r\n    \"00-05 minutes\",\r\n    \"05-10 minutes\",\r\n    \"10-15 minutes\",\r\n    \"15-20 minutes\",\r\n    \"20-25 minutes\",\r\n    \"25-30 minutes\",\r\n    \"more than 30 minutes\",\r\n    \"n.a.\"\r\n];\r\nlet Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n| where \"{AutomatedTriage}\"==\"\" or TriagedByAutomation == \"{AutomatedTriage:value}\"\r\n| where \"{ClosedXDR}\"==\"\" or ClosedByXDRCorrelation == \"{ClosedXDR:value}\"\r\n| extend Classification=iff(ClosedByXDRCorrelation==true,\"XDR\",Classification)\r\n| summarize IncidentCount=count() by TriageTimeInterval,Classification,ClosedByAutomation\r\n| join kind=leftouter TimeIntervals on $left.TriageTimeInterval==$right.TimeInterval\r\n// Visualize the data\r\n| project TimeInterval, IncidentCount = coalesce(IncidentCount, 0),Classification\r\n| order by TimeInterval asc\r\n| render columnchart with (kind=stacked)\r\n",
        "size": 0,
        "showAnalytics": true,
        "title": "Triage distribution time",
        "timeContextFromParameter": "TimeRange",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "IncidentId",
            "parameterName": "IncidentId",
            "parameterType": 1
          }
        ],
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "chartSettings": {
          "xAxis": "TimeInterval",
          "yAxis": [
            "IncidentCount"
          ],
          "group": "Classification",
          "createOtherGroup": null,
          "showLegend": true,
          "seriesLabelSettings": [
            {
              "seriesName": "<empty>",
              "label": "Open"
            }
          ],
          "xSettings": {
            "label": "Time taken to triage"
          },
          "ySettings": {
            "label": "Incidents"
          }
        }
      },
      "customWidth": "33",
      "name": "query - 6",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "//Time To triage:\r\nlet TimeIntervals = datatable(TimeInterval: string)\r\n[\r\n    \"00-05 minutes\",\r\n    \"05-10 minutes\",\r\n    \"10-15 minutes\",\r\n    \"15-20 minutes\",\r\n    \"20-25 minutes\",\r\n    \"25-30 minutes\",\r\n    \"more than 30 minutes\",\r\n    \"n.a.\"\r\n];\r\nlet Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n| where \"{AutomatedTriage}\"==\"\" or TriagedByAutomation == \"{AutomatedTriage:value}\"\r\n| where \"{ClosedXDR}\"==\"\" or ClosedByXDRCorrelation == \"{ClosedXDR:value}\"\r\n| extend Classification=iff(ClosedByXDRCorrelation==true,\"XDR\",Classification)\r\n| summarize IncidentCount=count() by AnalysisTimeInterval,Classification,ClosedByAutomation\r\n| join kind=leftouter TimeIntervals on $left.AnalysisTimeInterval==$right.TimeInterval\r\n// Visualize the data\r\n| project TimeInterval, IncidentCount = coalesce(IncidentCount, 0),Classification\r\n| order by TimeInterval asc\r\n| render columnchart with (kind=stacked)\r\n",
        "size": 0,
        "showAnalytics": true,
        "title": "Analysis distribution time",
        "timeContextFromParameter": "TimeRange",
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "IncidentId",
            "parameterName": "IncidentId",
            "parameterType": 1
          }
        ],
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "chartSettings": {
          "xAxis": "TimeInterval",
          "yAxis": [
            "IncidentCount"
          ],
          "group": "Classification",
          "createOtherGroup": null,
          "showLegend": true,
          "seriesLabelSettings": [
            {
              "seriesName": "<empty>",
              "label": "Open"
            }
          ],
          "xSettings": {
            "label": "Time taken to triage"
          },
          "ySettings": {
            "label": "Incidents"
          }
        }
      },
      "customWidth": "33",
      "name": "query - 6 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "//Time To triage:\r\nlet TimeIntervals = datatable(TimeInterval: string)\r\n[\r\n    \"00-05 minutes\",\r\n    \"05-10 minutes\",\r\n    \"10-15 minutes\",\r\n    \"15-20 minutes\",\r\n    \"20-25 minutes\",\r\n    \"25-30 minutes\",\r\n    \"more than 30 minutes\",\r\n    \"n.a.\"\r\n];\r\nlet Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n| where \"{AutomatedTriage}\"==\"\" or TriagedByAutomation == \"{AutomatedTriage:value}\"\r\n| where \"{ClosedXDR}\"==\"\" or ClosedByXDRCorrelation == \"{ClosedXDR:value}\"\r\n| where \"{AutomatedClosure}\"==\"\" or ClosedByAutomation == \"{AutomatedClosure:value}\"\r\n| summarize IncidentCount=count() by CloseTimeInterval,Classification,ClosedByAutomation\r\n| join kind=leftouter TimeIntervals on $left.CloseTimeInterval==$right.TimeInterval\r\n// Visualize the data\r\n| project TimeInterval, IncidentCount = coalesce(IncidentCount, 0),Classification\r\n| order by TimeInterval asc\r\n| render columnchart with (kind=stacked)\r\n",
        "size": 0,
        "showAnalytics": true,
        "title": "Closure distribution time",
        "timeContextFromParameter": "TimeRange",
        "showRefreshButton": true,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "IncidentName",
            "parameterName": "IncidentName",
            "parameterType": 1
          }
        ],
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "tileSettings": {
          "showBorder": false,
          "titleContent": {
            "columnMatch": "TimeInterval",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "IncidentCount",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        },
        "graphSettings": {
          "type": 0,
          "topContent": {
            "columnMatch": "TimeInterval",
            "formatter": 1
          },
          "centerContent": {
            "columnMatch": "IncidentCount",
            "formatter": 1,
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        },
        "chartSettings": {
          "xAxis": "TimeInterval",
          "yAxis": [
            "IncidentCount"
          ],
          "group": "Classification",
          "createOtherGroup": null,
          "showLegend": true,
          "seriesLabelSettings": [
            {
              "seriesName": "<empty>",
              "label": "Open"
            }
          ],
          "xSettings": {
            "label": "Time taken to close incident"
          }
        },
        "mapSettings": {
          "locInfo": "LatLong",
          "sizeSettings": "IncidentCount",
          "sizeAggregation": "Sum",
          "legendMetric": "IncidentCount",
          "legendAggregation": "Sum",
          "itemColorSettings": {
            "type": "heatmap",
            "colorAggregation": "Sum",
            "nodeColorField": "IncidentCount",
            "heatmapPalette": "greenRed"
          }
        }
      },
      "customWidth": "33",
      "name": "query - 7",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n| summarize count() by Title,Classification\r\n| project Title, IncidentCount = count_, Classification\r\n| order by IncidentCount desc\r\n| render columnchart with (kind=stacked) ",
        "size": 0,
        "showAnalytics": true,
        "title": "Incident Title by Closure Classification",
        "timeContextFromParameter": "TimeRange",
        "showRefreshButton": true,
        "exportMultipleValues": true,
        "exportedParameters": [
          {
            "fieldName": "IncidentName",
            "parameterName": "IncidentName",
            "parameterType": 1
          }
        ],
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "tileSettings": {
          "showBorder": false,
          "titleContent": {
            "columnMatch": "TimeInterval",
            "formatter": 1
          },
          "leftContent": {
            "columnMatch": "IncidentCount",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            },
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        },
        "graphSettings": {
          "type": 0,
          "topContent": {
            "columnMatch": "TimeInterval",
            "formatter": 1
          },
          "centerContent": {
            "columnMatch": "IncidentCount",
            "formatter": 1,
            "numberFormat": {
              "unit": 17,
              "options": {
                "maximumSignificantDigits": 3,
                "maximumFractionDigits": 2
              }
            }
          }
        },
        "chartSettings": {
          "xAxis": "Title",
          "group": "Classification",
          "createOtherGroup": null,
          "showLegend": true,
          "xSettings": {
            "label": "Incident Title"
          },
          "ySettings": {
            "label": "Number of incidents"
          }
        },
        "mapSettings": {
          "locInfo": "LatLong",
          "sizeSettings": "IncidentCount",
          "sizeAggregation": "Sum",
          "legendMetric": "IncidentCount",
          "legendAggregation": "Sum",
          "itemColorSettings": {
            "type": "heatmap",
            "colorAggregation": "Sum",
            "nodeColorField": "IncidentCount",
            "heatmapPalette": "greenRed"
          }
        }
      },
      "customWidth": "33",
      "name": "query - 7 - Copy",
      "styleSettings": {
        "showBorder": true
      }
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nlet AutomationUsed=SecurityIncident\r\n    | summarize AllModifiedBy = make_list(ModifiedBy) by IncidentNumber\r\n    | extend AutomationUsed = iff(AllModifiedBy has_any ('playbook', 'automation rule', 'External application'), 'yes', 'no');\r\nlet AnalyticRules = (\r\n    SentinelHealth\r\n    | where SentinelResourceType == \"Analytics Rule\"\r\n    | extend SentinelResourceId = tostring(ExtendedProperties.RuleId)\r\n    | summarize arg_max(TimeGenerated, *) by SentinelResourceId\r\n    );\r\nlet AllRules=SecurityIncident\r\n    | summarize arg_max(TimeGenerated, *) by IncidentNumber\r\n    | mv-expand RelatedAnalyticRuleIds\r\n    | extend RelatedAnalyticRuleIds = tostring(RelatedAnalyticRuleIds)\r\n    | join kind=leftouter AnalyticRules on $left.RelatedAnalyticRuleIds == $right.SentinelResourceId\r\n    | summarize AllRules = make_list(SentinelResourceName) by IncidentNumber;\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n| summarize arg_max(TimeGenerated,*) by IncidentNumber\r\n| join kind=leftouter AllRules on IncidentNumber\r\n| join AutomationUsed on IncidentNumber\r\n//| join kind=leftouter ClosedBy on IncidentNumber\r\n//| project IncidentNumber,Title,CreatedTime,Status,Severity,Owner,AllModifiedBy,Product,Tactics,IncidentName,AutomationUsed\r\n//| where ClosedByXDRCorrelation == false\r\n| where \"\" == \"\" or ClosedByAutomation == \"\"\r\n| project\r\n    IncidentNumber,\r\n    CreatedTime,\r\n    FirstModifiedTime,\r\n    LastModifiedTime,\r\n    TriageTime,\r\n    AcknowledgeTime,\r\n    ClosedTime,\r\n    AnalysisTimeMinutes,\r\n    AutomationUsed,\r\n    Title,\r\n    Severity,\r\n    Status,\r\n    Classification,\r\n    Owner,\r\n    Tactics,\r\n    AllModifiedBy,\r\n    ProductName,\r\n    ClosedByAutomation,\r\n    ClosedByXDRCorrelation,\r\n    IncidentUrl,\r\n    RelatedAnalyticRuleIds,\r\n    ProviderName,\r\n    AllRules\r\n| order by IncidentNumber asc\r\n",
        "size": 0,
        "title": "Incident Details",
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "gridSettings": {
          "formatters": [
            {
              "columnMatch": "CreatedTime",
              "formatter": 5
            },
            {
              "columnMatch": "FirstModifiedTime",
              "formatter": 5
            },
            {
              "columnMatch": "TriageTime",
              "formatter": 5
            },
            {
              "columnMatch": "AcknowledgeTime",
              "formatter": 5
            },
            {
              "columnMatch": "ClosedTime",
              "formatter": 5
            },
            {
              "columnMatch": "AnalysisTimeMinutes",
              "formatter": 5
            },
            {
              "columnMatch": "AutomationUsed",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "icons",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "no",
                    "representation": "more",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "success",
                    "text": "{0}{1}"
                  }
                ]
              }
            },
            {
              "columnMatch": "Title",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "GenericDetails",
                "linkIsContextBlade": true
              }
            },
            {
              "columnMatch": "Severity",
              "formatter": 18,
              "formatOptions": {
                "thresholdsOptions": "colors",
                "thresholdsGrid": [
                  {
                    "operator": "==",
                    "thresholdValue": "High",
                    "representation": "redBright",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "==",
                    "thresholdValue": "Medium",
                    "representation": "yellow",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "==",
                    "thresholdValue": "Informational",
                    "representation": "blue",
                    "text": "{0}{1}"
                  },
                  {
                    "operator": "Default",
                    "thresholdValue": null,
                    "representation": "green",
                    "text": "{0}{1}"
                  }
                ]
              }
            },
            {
              "columnMatch": "Tactics",
              "formatter": 5
            },
            {
              "columnMatch": "ModifiedBy",
              "formatter": 5
            },
            {
              "columnMatch": "Product",
              "formatter": 5
            },
            {
              "columnMatch": "IncidentUrl",
              "formatter": 7,
              "formatOptions": {
                "linkTarget": "Url"
              }
            },
            {
              "columnMatch": "RelatedAnalyticRuleIds",
              "formatter": 5
            },
            {
              "columnMatch": "ProviderName",
              "formatter": 5
            },
            {
              "columnMatch": "AllRules",
              "formatter": 5
            },
            {
              "columnMatch": "IncidentName",
              "formatter": 5
            }
          ],
          "sortBy": [
            {
              "itemKey": "ClosedByXDRCorrelation",
              "sortOrder": 2
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "ClosedByXDRCorrelation",
            "sortOrder": 2
          }
        ]
      },
      "name": "query - 8"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let Incidents=dynamic([{IncidentTitle}]);\r\nlet Severity=dynamic([{Severity}]);\r\nlet StartTime=todatetime({TimeRange:start});\r\nlet EndTime=todatetime({TimeRange:end});\r\nlet Products=dynamic([{Product}]);\r\nlet Owner=dynamic([{Owner}]);\r\nlet Tactics=dynamic([{Tactics}]);\r\nIncidentData(startTime=StartTime,endTime=EndTime,IncidentTitle=Incidents,SeverityLevel=Severity,Product=Products,CurrentOwner=Owner,Tactics=Tactics)\r\n",
        "size": 0,
        "timeContextFromParameter": "TimeRange",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspaces}"
        ],
        "gridSettings": {
          "sortBy": [
            {
              "itemKey": "Owner",
              "sortOrder": 2
            }
          ]
        },
        "sortBy": [
          {
            "itemKey": "Owner",
            "sortOrder": 2
          }
        ]
      },
      "name": "query - 10"
    }
  ],
  "fromTemplateId": "sentinel-UserWorkbook",
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}